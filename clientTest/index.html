<html>
  <head>
    <script
      src="https://cdn.socket.io/4.4.1/socket.io.min.js"
      integrity="sha384-fKnu0iswBIqkjxrhQCTZ7qlLHOFEgNkRmK2vaO/LbTZSXdJfAu6ewRBdwHPhBo/H"
      crossorigin="anonymous"
    ></script>
  </head>

  <body>
    <table border="1">
      <tr>
        <td>client id</td>
        <td><span id="curId"></span></td>
      </tr>
      <tr>
        <td><label for="client-id">id:</label></td>
        <td><input type="text" id="client-id" /></td>
      </tr>
      <tr>
        <td><label for="content">content:</label></td>
        <td><textarea type="text" id="content"></textarea></td>
      </tr>
    </table>
    <button onclick="sendHello()">sendMsg hello</button>
    <script>
      const curIdEl = (q = document.querySelector('#curId'));
      const idEl = document.querySelector('#client-id');
      const contentEl = document.querySelector('#content');

      const socket = io('http://localhost:3000/chat-websocket', {
        transports: ['websocket'],
      });
      socket.on('connect', function () {
        console.log('Connected');
        curIdEl.innerText = socket.id;
      });
      socket.on('CLIENT_GET_CHAT_DATA', function (data) {
        console.log('event', data);
      });

      function sendHello() {
        const id = idEl.value;
        const msg = contentEl.value;
        socket.emit('EVENT_MESSAGE', {
          data: { toId: id, data: msg },
          type: 'CHAT_WITH_SOMEONE',
        });
      }
    </script>
  </body>
</html>
